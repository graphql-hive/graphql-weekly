---
import Layout from "../layouts/Layout.astro";
import { Button } from "../components/Button";
import "../index.css";

const repositoryUrl = "https://github.com/graphql-hive/graphql-weekly";
---

<Layout title="Access Required - GraphQL Weekly CMS">
  <div class="min-h-screen bg-neu-50 dark:bg-neu-950 grid grid-cols-12 gap-4 p-6 md:p-12">
    <!-- Left column: decorative accent -->
    <div class="col-span-1 hidden md:flex flex-col justify-between py-8">
      <div class="w-px h-32 bg-gradient-to-b from-[#C2F653] to-transparent"></div>
      <div class="w-px h-32 bg-gradient-to-t from-[#C2F653]/30 to-transparent"></div>
    </div>

    <!-- Main content: left-aligned -->
    <div class="col-span-12 md:col-span-7 flex flex-col justify-center min-h-[80vh]">
      <h1 class="text-4xl md:text-5xl lg:text-6xl text-neu-900 dark:text-neu-100 mb-8 leading-[1.1]">
        Access Required
      </h1>

      <div class="space-y-4 mb-12 max-w-lg">
        <p class="text-neu-600 dark:text-neu-400 text-lg">
          You need to be a collaborator on the repository to access the CMS.
        </p>
        <p class="text-sm text-neu-500">
          Ask a repository admin to add you as a collaborator.
        </p>
      </div>

      <div class="flex flex-col sm:flex-row sm:items-center gap-4">
        <Button id="sign-out-btn" variant="primary" size="md" client:load>
          Sign out
        </Button>

        <Button href={repositoryUrl} variant="secondary" size="md" target="_blank" rel="noopener noreferrer" client:load>
          <svg class="size-4" viewBox="0 0 24 24">
            <path
              d="M5 2h4v2H7v2H5V2Zm0 10H3V6h2v6Zm2 2H5v-2h2v2Zm2 2v-2H7v2H3v-2H1v2h2v2h4v4h2v-4h2v-2H9Zm0 0v2H7v-2h2Zm6-12v2H9V4h6Zm4 2h-2V4h-2V2h4v4Zm0 6V6h2v6h-2Zm-2 2v-2h2v2h-2Zm-2 2v-2h2v2h-2Zm0 2h-2v-2h2v2Zm0 0h2v4h-2v-4Z"
              fill="currentColor"
            />
          </svg>
          View GitHub
        </Button>
      </div>
    </div>

    <!-- Right column: visual interest -->
    <div class="col-span-4 hidden md:flex items-end justify-end pb-12">
      <svg class="size-48 lg:size-64 text-neu-900 dark:text-neu-800 opacity-50" viewBox="0 0 24 24">
        <path fill="currentColor" d="M22 2H2v12h2V4h16v10h2V2zM6 14H4v2h2v-2zm0 2h2v2h2v2H8v-2H6v-2zm4 4v2h4v-2h2v-2h-2v2h-4zm10-6h-2v2h-2v2h2v-2h2v-2z" />
      </svg>
    </div>
  </div>
</Layout>

<script>
  import { signOut } from "../client/auth";

  document.getElementById("sign-out-btn")?.addEventListener("click", () => {
    signOut({ fetchOptions: { onSuccess: () => { window.location.href = "/login"; } } });
  });
</script>
